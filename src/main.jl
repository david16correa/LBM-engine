include("preamble.jl")
include("structs.jl");
include("aux.jl");
include("functions.jl");

#= ==========================================================================================
=============================================================================================
main
=============================================================================================
========================================================================================== =#

len, dims = 100, 2; 
ρ = [1. for _ in Array{Int64}(undef, (len for _ in 1:dims)...)];
u = [[0. for _ in 1:dims] for _ in ρ];
model = modelInit(ρ, u; τ = 1.);

@time for _ in 1:101
    LBMpropagate!(model);
end

#= ==========================================================================================
=============================================================================================
misc
=============================================================================================
========================================================================================== =#

t = 101
ρ = massDensity(model; time = t);
fig, ax, hm = heatmap(ρ, 
    axis=(
        title = "mass density, t = $(model.time[t])",
    )
);
Colorbar(fig[1,2], hm);
fig

